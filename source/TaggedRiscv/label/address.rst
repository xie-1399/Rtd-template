.. role:: raw-html-m2r(raw)
   :format: html

内存隔离
============================

处理器采用位于L2 Cache下的二级地址翻译模块实现多标签下不同程序间物理地址的隔离。

 - **标签传递**：通过AXI总线中的user（可自定义信号）携带请求所属的标签值。其中标签0属于管理程序，可访问所有的物理空间，并不进行转换。
\
 - **地址二级翻译**：二级地址翻译模块采用多组寄存器保存每个标签所分配内存的起始地址与大小，在请求到来时根据标签值重新计算实际的物理地址并将转换完成的AXI请求发出。
\
 - **异常触发**：当访问的地址超过了该标签所分配的内存地址范围，通过AXI总线的RRESP信号向上层Cache返回异常信号，该异常信号存储在Cache的状态位中，待处理器访问该Cache行时，由Fetch单元或LSU单元触发标签越权访问异常进行异常处理。
\
 .. image:: /asset/image/except.png
          :width: 400 px
          :align: center
\
 - **寄存器配置**：二级地址翻译模块可通过外设总线进行配置，通过总线隔离模块进行访问控制，只允许标签0（管理程序）进行读写以配置每个标签所分配的地址空间及大小。
\
 - **DMA适配**：DMA对内存的访问同样需要经过该模块的处理。