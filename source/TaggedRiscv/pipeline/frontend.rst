.. role:: raw-html-m2r(raw)
   :format: html

顺序前端
============================

流水线前端采用顺序结构，整体架构如下：

    .. image:: /asset/image/frontend.jpg
      :align: center

- **分支预测单元 :** 采用GShare + BTB + RAS的分支预测方法。

  取指阶段会分成多个流水级，并会与多级分支预测器进行结合。在设计中分支预测器采用GShare分支预测器与BTB表预测直接跳转指令，使用RAS栈式结构预测间接跳转指令。通过GShare分支预测器预测跳转的方向，在BTB表中记录直接跳转的目标地址，如果BTB表命中并且GShare预测跳转时，则会在下一个阶段进行PC的跳转，并重新进行取指。如果BTB表项缺失或者GShare不预测跳转时则会进入译码阶段的分支预测。在译码阶段，将有更多的信息用于分支预测，在执行单元通过对分支指令进行计算，并与缓存中的分支指令跳转值进行比较，如果不匹配则需要进行PC的修正并对流水线进行冲刷。在提交阶段，如果分支指令进行了提交，将进行分支预测器的学习与更新。
\

- **译码单元 :** 支持RISC-V [I][M][A][C][F][D]模块指令集，如果是压缩指令格式，可进行指令的解压缩操作。
\

- **寄存器重命名与分配单元：** 该单元用于动态实现逻辑寄存器到物理寄存器的映射，在寄存器分配阶段通过查找空闲寄存器表，找到没有分配的物理寄存器。从逻辑寄存器到物理寄存器的映射主要通过寄存器映射表完成，寄存器映射表存放逻辑寄存器与物理寄存器的位置关系，并可以选择在解码阶段或者提交阶段对映射表进行更新。通过一个包含未分配物理寄存器索引的循环缓冲区进行物理寄存器的重分配。在完成重命名后会将指令之前对应的映射关系保存到ROB中，便于后续指令退休后恢复物理寄存器的状态。
\

- **ROB** : ROB表用于记录每条指令的状态信息。
